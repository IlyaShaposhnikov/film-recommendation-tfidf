# Movie Recommendation System [NLP, TF-IDF]

Пет-проект для рекомендации фильмов на основе методов обработки естественного языка (NLP) и TF-IDF с 2 интерфейсами: консольный и Telegram бот.

## Особенности

*   Рекомендации на основе жанров и ключевых слов фильмов
*   Рекомендации на основе актерского состава (весовой подход с учетом порядка в титрах)
*   Использование TF-IDF для векторизации текста
*   Косинусная схожесть для нахождения похожих фильмов
*   Интерактивный интерфейс для поиска фильмов и получения рекомендаций
*   Визуализации для понимания работы алгоритма
*   Два интерфейса: консольный и Telegram бот

## Структура проекта

```
film-recommendation-tfidf/
├── data/                      # Данные проекта
│ ├── tmdb_5000_movies.csv     # Данные о фильмах (скачивается пользователем)
│ └── tmdb_5000_credits.csv    # Данные об актерах (скачивается пользователем)
├── core/                      # Основная логика системы
│ ├── data_loader.py           # Загрузка и подготовка данных
│ ├── genres_recommender.py    # Рекомендации по жанрам
│ └── actors_recommender.py    # Рекомендации по актерам
├── interfaces/                # Интерфейсы пользователя
│ ├── config.py                # Конфигурация для бота
│ ├── console_genres.py        # Консольный интерфейс (жанры)
│ ├── console_actors.py        # Консольный интерфейс (актеры)
│ ├── telegram_bot.py          # Telegram бот
│ ├── demo_genres.py           # Учебные примеры (жанры)
│ └── demo_actors.py           # Учебные примеры (актеры)
├── visualizations/            # Графики и визуализации
├── .env.example               # Пример файла переменных окружения
├── requirements.txt           # Зависимости Python
└── README.md                  # Документация
```

## Установка и запуск

### 1.  Клонируйте репозиторий:
```bash
git clone https://github.com/IlyaShaposhnikov/film-recommendation-tfidf.git
cd film-recommendation-tfidf
```

### 2.  Создайте виртуальное окружение и установите зависимости:
```bash
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
```

### 3.  [Скачайте датасеты](https://www.kaggle.com/tmdb/tmdb-movie-metadata):
Kaggle - платформа и сообщество для специалистов по Data Science и машинному обучению.

Датасеты:
*   `tmdb_5000_movies.csv`
*   `tmdb_5000_credits.csv`

Поместите файлы в папку `data` в корне проекта.

### 4.  Создайте и настройте Telegram бота:
1.  Найдите `@BotFather` в Telegram
2.  Отправьте команду `/newbot`
3.  Выберите имя и `@username` для бота
4.  Полученный токен сохраните в файле `.env` в корне проекта (см. `.env.example`)
5.  Настройте команды меню бота через `@BotFather`:
    +  `/start` - Начать работу с ботом
    +  `/help` - Получить помощь
    +  `/genres` - Рекомендации по жанрам
    +  `/actors` - Рекомендации по актерам

### 5.  Запустите приложение:
*  Telegram бот:
    ```bash
    python -m interfaces.telegram_bot
    ```
*  Консольный интерфейс:
    + Система рекомендаций фильмов на основе жанров и ключевых слов (с визуализациями)
        ```bash
        python -m interfaces.console_genres
        ```
    + Система рекомендаций фильмов на основе актерского состава
        ```bash
        python -m interfaces.console_actors
        ```

### 6.  Для изучения работы алгоритма (наглядные примеры для демонстрации теории TF-IDF):
```bash
python interfaces/demo_genres.py
python interfaces/demo_actors.py
```

### 7.  Использование Telegram бота
1. Начало работы - отправьте команду `/start`
2. Выбор типа рекомендаций - нажмите кнопку "По жанрам" или "По актерам"
3. Поиск фильма - введите часть названия фильма на английском (минимум 3 буквы)
4. Выбор фильма - выберите номер фильма из списка
5. Получение рекомендаций - бот покажет топ похожих фильмов
6. Дополнительные действия - используйте кнопки для нового поиска или смены типа рекомендаций

## Алгоритм работы

### Для рекомендаций по жанрам:

1. **Предобработка данных:** Извлечение жанров и ключевых слов из JSON
2. **Векторизация:** Преобразование текста в числовые векторы с помощью TF-IDF
3. **Вычисление схожести:** Косинусная схожесть между векторами фильмов
4. **Рекомендации:** Выбор фильмов с наибольшей схожестью

### Для рекомендаций по актерам:

1. **Извлечение актеров:** Парсинг JSON с данными об актерах
2. **Взвешивание:** Учет порядка в титрах (главные актеры имеют больший вес)
3. **Векторизация:** TF-IDF для представления актерского состава
4. **Схожесть:** Косинусная схожесть между взвешенными актерскими составами

## Технические детали

*   **TF-IDF (Term Frequency-Inverse Document Frequency):** Метод оценки важности слова в документе относительно коллекции документов
*   **Косинусная схожесть:** Метрика для измерения схожести между двумя векторами
*   **Стоп-слова:** Удаление общеупотребительных слов, не несущих смысловой нагрузки
*   **JSON парсинг:** Извлечение структурированных данных из строковых полей
*   **Взвешенный подход:** Учет порядка актеров в титрах

## Зависимости

Проект использует следующие библиотеки Python:

*   `pandas` для работы с данными
*   `scikit-learn` для машинного обучения
*   `matplotlib` для визуализации
*   `numpy` для численных операций
*   `python-telegram-bot` для Telegram бота
*   `python-dotenv` для загрузки конфигурации

**Автор:**
Шапошников Илья

https://github.com/IlyaShaposhnikov/

ilia.a.shaposhnikov@gmail.com